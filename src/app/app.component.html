<md-sidenav-container>

  <md-sidenav #sidenav mode="over" class="app-sidenav">
    <h4>Configuration</h4>
    <section class="sidenav-section">
      <md-button-toggle-group #group="mdButtonToggleGroup">
        <md-button-toggle value="1">
          <md-icon>format_align_left</md-icon>
        </md-button-toggle>
        <md-button-toggle value="2">
          <md-icon>format_align_right</md-icon>
        </md-button-toggle>
      </md-button-toggle-group>
    </section>

    <section class="sidenav-section">
      <md-radio-group class="sidenav-radio-group">
        <md-radio-button class="sidenav-radio-button" value="1">
          Operation</md-radio-button>
        <md-radio-button class="sidenav-radio-button" value="2">
          Block</md-radio-button>
        <md-radio-button class="sidenav-radio-button" value="3">
          Function</md-radio-button>
        <md-radio-button class="sidenav-radio-button" value="4">
          Global</md-radio-button>
      </md-radio-group>
    </section>

  </md-sidenav>

  <div class='app-content'>
    <div #graphContainer
      [ngClass]="{'side-by-side': displayMode==2 && selectedRight}"></div>
    <div #secondGraphContainer *ngIf='displayMode==2 && selectedRight'
      class='side-by-side right-panel'>Some content</div>
    </div>


  <md-toolbar class="omnibox mat-elevation-z6">
    <button class="app-menu-button" (click)="sidenav.toggle()">
      <md-icon>menu</md-icon>
    </button>
    <md-input-container floatPlaceholder="never" class="omnibox-input">
      <input mdInput placeholder="Try *dll* or *fcn* or push" [formControl]='query'>
    </md-input-container>
  </md-toolbar>

  <md-button-toggle-group #group="mdButtonToggleGroup" class="display-mode">
    <md-button-toggle value="1" (click)='switchDisplay(1)' selected>
      <md-icon>map</md-icon>
    </md-button-toggle>
    <md-button-toggle value="2" (click)='switchDisplay(2)'>
      <md-icon>compare</md-icon>
    </md-button-toggle>
    <!--<md-button-toggle value="3" disabled>
      <md-icon>movie-creation</md-icon>
    </md-button-toggle>-->
  </md-button-toggle-group>
  <div class="example-selected-value">Selected value: {{group.value}}</div>

  <div
    class="omnibox-results mat-elevation-z4"
    *ngIf="total!=undefined && selected==false">
    <md-list>
      <md-list-item *ngFor="let result of results" class="omnibox-result-item"
        (click)='selectGraph(result._id, result._source.location.lon, result._source.location.lat)'> 
        <h3 class='malware-name' md-line>{{ result._source.title }}</h3>
        <ul md-line class='graph-attr'>
          <li class='malware-type'>Type: <span>{{ result._source.family }}</span></li> 
          <li class='node-count'>Nodes: <span>{{ result._source.nodes }}</span></li> 
          <li class='edge-count'>Edges: <span>{{ result._source.edges }}</span></li>
          <li class='cluster-count'>Clusters: <span>{{ result._source.clusters }}</span></li>
          <li class='cycle-count'>Cycles: <span>{{ result._source.cycles }}</span></li>
        </ul>
        <md-divider></md-divider>
        <p md-line class='highlight' *ngIf="result.highlight && result.highlight.dot" 
          [innerHTML]="result.highlight.dot[0]"></p>
        <p md-line class='highlight' *ngIf="result.highlight && !result.highlight.dot && result.highlight.string" 
          [innerHTML]="result.highlight.string[0]"></p>
      </md-list-item>
      <md-list-item *ngIf="results.length==0"> No results</md-list-item>
    </md-list>
  </div>


  <!--<div class='reporter'>
    <h3 >Node ID: {{selectedNode}}</h3>
  </div>-->




  <div
    class="graph-stats mat-elevation-z4"
    [ngClass]="{'display': total==undefined && displayMode==1 && statsToggle}">
    <md-icon class='close-button' (click)='statsToggle=!statsToggle'>close</md-icon>
    <!--<md-tab-group>
      <md-tab label="Graph">Graph</md-tab>
      <md-tab label="Subgraph">Subgraph</md-tab>
    </md-tab-group>-->
    <h4 *ngIf='nodeStats'>{{ nodeStats.id }} - {{ nodeStats.label.slice(0,22) }}
      <span *ngIf='nodeStats.label.length>22'>...</span>
    </h4>
    <md-list dense *ngIf='nodeStats'>
      <!--<li>Edge In: {{ nodeStats.in }}</li>
      <li>Edge Out: {{ nodeStats.out }}</li>
      <li>Predecessors: {{ nodeStats.predecessors.join(', ') }}</li>
      <li>Successors: {{ nodeStats.successors.join(', ') }}</li>-->
      <md-list-item>Edge In: {{ nodeStats.in }} &nbsp;&nbsp;&nbsp;&nbsp; Edge Out: {{ nodeStats.out }}</md-list-item>
      <!--<md-list-item></md-list-item>-->
      <md-list-item>Predecessors: [{{ nodeStats.predecessors.join(', ') }}]</md-list-item>
      <md-list-item>Successors: [{{ nodeStats.successors.join(', ') }}]</md-list-item>
    </md-list>
    <!--<h4>1grams</h4>-->
    <div id='subgraphStats'></div>
  </div>

  <div class="similar-graphs mat-elevation-z4" 
    [ngClass]="{'display': displayMode==2}">
    <div class="card-container">
      <md-card *ngFor="let result of resultsRight" (click)='selectSimilarGraph(result._id)'
        class="similar-result-item">
        <md-card-header>
          <md-card-title>{{ result._source.title }}</md-card-title>
        </md-card-header>
        <md-card-content>
          <ul md-line class='graph-attr'>
            <li class='distance'>Distance: <span>{{ result.sort[0] | number:'1.0-0' }}</span></li> 
            <li class='malware-type'>Type: <span>{{ result._source.family }}</span></li> 
            <li class='node-count'>Nodes: <span>{{ result._source.nodes }}</span></li> 
            <li class='edge-count'>Edges: <span>{{ result._source.edges }}</span></li>
            <li class='cluster-count'>Clusters: <span>{{ result._source.clusters }}</span></li>
            <li class='cycle-count'>Cycles: <span>{{ result._source.cycles }}</span></li>
          </ul>
        </md-card-content>
      </md-card>
    </div>

    <!--<md-list>
      <md-list-item *ngFor="let result of resultsRight" class="similar-result-item"
        (click)='selectSimilarGraph(result._id)'> 
        <h3 class='malware-name' md-line>{{ result._source.title }}</h3>
        <ul md-line class='graph-attr'>
          <li class='malware-type'>Type: <span>{{ result._source.family }}</span></li> 
          <li class='node-count'>Nodes: <span>{{ result._source.nodes }}</span></li> 
          <li class='edge-count'>Edges: <span>{{ result._source.edges }}</span></li>
          <li class='cluster-count'>Clusters: <span>{{ result._source.clusters }}</span></li>
          <li class='cycle-count'>Cycles: <span>{{ result._source.cycles }}</span></li>
        </ul>

      </md-list-item>
      <md-list-item *ngIf="resultsRight?.length==0"> No results</md-list-item>
    </md-list>  -->
  </div>
  
</md-sidenav-container>

<!--<span class="app-action" [class.m2app-dark]="isDarkTheme">
  <button md-fab><md-icon>check circle</md-icon></button>
</span>-->